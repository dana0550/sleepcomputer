---
doc_type: feature_spec
id: F-002.01
name: Mode and Status Modeling
status: active
owner: dshakiba
parent: F-002
children: []
aliases:
  - Mode Derivation
version: 1.0.0
last_reviewed: 2026-02-18
tags:
  - ui
  - domain
risk_level: low
dependencies:
  - F-002
  - F-005
---

# [F-002.01] Mode and Status Modeling

## Summary

Map low-level app state to user-facing mode labels, descriptions, and icon selection.

## Goals

- Keep mode precedence deterministic.
- Provide consistent status text and detail messaging.
- Keep icon mappings explicit for menu bar and rows.

## Non-Goals

- Persisting UI mode independently of app state.
- Dynamic theming logic.

## Requirements

- R1: Mode derivation priority must be `closedLidEnabledByApp` > `externalClosedLidDetected` > `openLidEnabled` > off.
- R2: Each mode must expose human-readable `statusText` and `statusDetailText`.
- R3: Status-bar icon mapping must use closed-lid asset for both closed-lid and external modes.
- R4: Dropdown row icon pairs must expose explicit OFF/ON asset names for open and closed rows.

<!-- AUTOGEN:REQUIREMENTS_CHECKLIST -->
- [x] R1
- [x] R2
- [x] R3
- [x] R4

## Acceptance Criteria

- AC1: Unit tests cover mode priority and text mapping behavior.
- AC2: Unit tests cover status-bar and dropdown icon mappings.
- AC3: External closed-lid mode always renders as `Stay Awake (External)`.

<!-- AUTOGEN:ACCEPTANCE_CHECKLIST -->
- [x] AC1
- [x] AC2
- [x] AC3

## Traceability

<!-- AUTOGEN:TRACEABILITY -->
| Item | Type | Evidence |
|---|---|---|
| R1 | code | AwakeBar/Domain/KeepAwakeMode.swift |
| R2 | code | AwakeBar/Domain/KeepAwakeMode.swift |
| R3 | code | AwakeBar/UI/MenuIconCatalog.swift |
| R4 | code | AwakeBar/UI/MenuIconCatalog.swift |
| AC1 | test | AwakeBarTests/KeepAwakeModeTests.swift |
| AC2 | test | AwakeBarTests/MenuIconCatalogTests.swift |
| AC3 | test | AwakeBarTests/KeepAwakeModeTests.swift |

## Children

<!-- AUTOGEN:CHILDREN -->
- None

## References

<!-- AUTOGEN:REFERENCES -->
- [F-002](./F-002-menu-bar-experience.md)
- [F-005](./F-005-iconography-asset-pipeline.md)

## API Contract

<!-- AUTOGEN:API_CONTRACT_SUMMARY -->
- `KeepAwakeMode.from(state:)`
- `KeepAwakeMode.statusText`
- `KeepAwakeMode.statusDetailText`
- `MenuIconCatalog`

## Impact

<!-- AUTOGEN:IMPACT_MAP -->
- Ensures status text and icon state remain coherent across app UI.

## Security

<!-- AUTOGEN:SECURITY_CHECKLIST -->
- [x] Pure state mapping with no privileged side effects

## Budget

<!-- AUTOGEN:BUDGET_CHECKLIST -->
- [x] Constant-time state derivation and mapping

## Table of Contents

<!-- AUTOGEN:TOC -->
- Summary
- Goals
- Non-Goals
- Requirements
- Acceptance Criteria

<!-- DO NOT EDIT BELOW (AUTOGENERATED) -->

## Changelog

- 2026-02-18: Initial child spec created.
