---
doc_type: feature_spec
id: F-001
name: Core Awake Control
status: active
owner: dshakiba
parent: null
children: []
aliases: []
version: 1.0.0
last_reviewed: 2026-02-17
tags:
  - power
  - sleep
risk_level: medium
dependencies:
  - F-002
---

# [F-001] Core Awake Control

## Summary

Provide the primary open-lid keep-awake mode exposed as Full Caffeine.

## Goals

- Keep system and display awake while Full Caffeine is enabled.
- Provide deterministic toggle behavior from menu bar.

## Non-Goals

- Changing system sleep policy globally.

## Requirements

- R1: Enabling Full Caffeine creates both NoIdleSleep and NoDisplaySleep assertions.
- R2: Disabling Full Caffeine releases all created assertions.
- R3: Assertion failures are surfaced to users as transient errors.

<!-- AUTOGEN:REQUIREMENTS_CHECKLIST -->
- [ ] R1
- [ ] R2
- [ ] R3

## Acceptance Criteria

- AC1: `pmset -g assertions` shows AwakeBar sleep-prevention assertions when enabled.
- AC2: Assertions are absent after disabling Full Caffeine.

<!-- AUTOGEN:ACCEPTANCE_CHECKLIST -->
- [ ] AC1
- [ ] AC2

## Traceability

<!-- AUTOGEN:TRACEABILITY -->
| Item | Type | Evidence |
|---|---|---|
| R1 | test | AwakeBarTests/MenuBarControllerTests.swift |
| R2 | test | AwakeBarTests/MenuBarControllerTests.swift |
| R3 | test | AwakeBarTests/MenuBarControllerTests.swift |
| AC1 | manual | `pmset -g assertions` validation |
| AC2 | manual | `pmset -g assertions` validation |

## Children

<!-- AUTOGEN:CHILDREN -->
- None

## References

<!-- AUTOGEN:REFERENCES -->
- [F-002]

## API Contract

<!-- AUTOGEN:API_CONTRACT_SUMMARY -->
- `OpenLidSleepControlling.setEnabled(_:)`

## Impact

<!-- AUTOGEN:IMPACT_MAP -->
- Affects menu status and icon state.

## Security

<!-- AUTOGEN:SECURITY_CHECKLIST -->
- [x] No credential storage
- [x] No network calls

## Budget

<!-- AUTOGEN:BUDGET_CHECKLIST -->
- [x] Idle CPU budget near zero when disabled

## Table of Contents

<!-- AUTOGEN:TOC -->
- Summary
- Goals
- Non-Goals
- Requirements
- Acceptance Criteria

<!-- DO NOT EDIT BELOW (AUTOGENERATED) -->

## Changelog

- 2026-02-17: Initial spec created.
