---
doc_type: feature_spec
id: F-006.01
name: Local Notarization Script
status: active
owner: dshakiba
parent: F-006
children: []
aliases:
  - release-notarize.sh
version: 1.0.0
last_reviewed: 2026-02-18
tags:
  - release
  - cli
risk_level: high
dependencies:
  - F-006
---

# [F-006.01] Local Notarization Script

## Summary

Run full local release packaging flow (sign, notarize, staple, zip, checksum) using environment-provided credentials.

## Goals

- Provide local parity with CI release path.
- Fail fast when required secrets are absent.
- Produce versioned distributable artifacts.

## Non-Goals

- Secret retrieval from remote vaults.
- Multi-platform package production.

## Requirements

- R1: Script must enforce presence of required signing/notary environment variables.
- R2: Script must create and unlock temporary keychain and import Developer ID certificate.
- R3: Script must run `xcodegen`, archive release build, and set `AWAKEBAR_TEAM_ID` from `APPLE_TEAM_ID`.
- R4: Script must notarize, staple, zip final app, and output `.sha256` checksum.

<!-- AUTOGEN:REQUIREMENTS_CHECKLIST -->
- [x] R1
- [x] R2
- [x] R3
- [x] R4

## Acceptance Criteria

- AC1: Missing any required env var causes immediate non-zero exit.
- AC2: Successful flow emits notarized ZIP in `dist/` and checksum sidecar.
- AC3: Release build verifies with `codesign --verify` and `spctl --assess` before notarization.

<!-- AUTOGEN:ACCEPTANCE_CHECKLIST -->
- [x] AC1
- [ ] AC2
- [x] AC3

## Traceability

<!-- AUTOGEN:TRACEABILITY -->
| Item | Type | Evidence |
|---|---|---|
| R1 | code | Scripts/release-notarize.sh |
| R2 | code | Scripts/release-notarize.sh |
| R3 | code | Scripts/release-notarize.sh |
| R4 | code | Scripts/release-notarize.sh |
| AC1 | code | Scripts/release-notarize.sh |
| AC2 | manual | Local release execution |
| AC3 | code | Scripts/release-notarize.sh |

## Children

<!-- AUTOGEN:CHILDREN -->
- None

## References

<!-- AUTOGEN:REFERENCES -->
- [F-006](./F-006-signed-release-notarization.md)
- [F-003](./F-003-closed-lid-admin-control.md)

## API Contract

<!-- AUTOGEN:API_CONTRACT_SUMMARY -->
- `Scripts/release-notarize.sh`

## Impact

<!-- AUTOGEN:IMPACT_MAP -->
- Enables reproducible local release dry-runs before CI tag publication.

## Security

<!-- AUTOGEN:SECURITY_CHECKLIST -->
- [x] Explicit secret gating
- [x] Keychain-scoped certificate import
- [x] Notarization + staple verification path

## Budget

<!-- AUTOGEN:BUDGET_CHECKLIST -->
- [x] Single-run release pipeline with bounded steps

## Table of Contents

<!-- AUTOGEN:TOC -->
- Summary
- Goals
- Non-Goals
- Requirements
- Acceptance Criteria

<!-- DO NOT EDIT BELOW (AUTOGENERATED) -->

## Changelog

- 2026-02-18: Initial child spec created.
